<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CDMA Tools</title>
  
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />

  <!-- FullCalendar CSS -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet" />
  <style>
    html, body {
      height: 100%;
      width: 100%;
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      height: 100vh;
      overflow: hidden;
    }
    
    .header {
      text-align: center;
      padding: 20px 0;
    }

    #calendarView {
      max-width: 100%;
      margin: 0 auto;
      height: 600px;
    }

    .tab-pane {
      padding-top: 20px;
    }
    .top-header {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 60px;
        background-color: #012d3a;
        color: #ffffff;
        display: flex;
        align-items: center;
        padding-left: 240px; /* pushes the text away from sidebar */
        z-index: 1000;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
    .top-header h1 {
        font-size: 18px;
        font-weight: normal;
    }
    .sidebar {
      width: 220px;
      background-color: #012d3a;
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px 0;
      position: fixed;
      top: 60px;
      left: 0;
      bottom: 0;
      height: calc(100vh - 60px);
      overflow-y: auto;
    }

    .sidebar h1 {
      font-size: 20px;
      margin-bottom: 5px;
    }

    .sidebar h3 {
      font-size: 14px;
      font-weight: normal;
      margin-bottom: 30px;
    }

    .nav-links {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: stretch;
    }

    .nav-links button {
      background: none;
      border: none;
      color: white;
      padding: 15px 20px;
      text-align: left;
      font-size: 15px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .nav-links button:hover,
    .nav-links button.active {
      background-color: #1e4b5a;
    }

.main-content {
  margin-left: 220px;
  margin-top: 60px; /* below header */
  padding: 30px;
  height: calc(100vh - 60px);
  width: 150%;
  overflow-y: auto;
  background: linear-gradient(45deg, #e7ede4, #f5f9f1);
}

    section {
      display: none;
      background-color: #ffffff;
      border-radius: 8px;
      padding: 50px;
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }

    section.active {
      display: block;
    }

    h2 {
      color: #014357;
    }

    input[type="text"], textarea, input[type="number"], input[type="file"] {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
    }

    button {
      padding: 10px 15px;
      background-color: #014357;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
    }

    button:hover {
      background-color: #126b83;
    }

    .WordCount, #charCount {
      margin-right: 10px;
      background-color: #eef1ed;
      padding: 10px;
      border-radius: 5px;
      display: inline-block;
    }
        .footer {
        margin: 20px 0;
        background-color: #012d3a;
        color: white;
        text-align: center;
    }
    .card {
            margin: 20px;
        }
      /* Top Header */
  </style>
</head>
<body>
    <!-- Top Page Header -->
  <header class="top-header">
    <h1>Free datamanagement tools by Chuk Umunna</h1>
  </header>
  <!-- Sidebar -->
<div class="sidebar">
    <div class="nav-links">
      <button onclick="showSection('home')" class="active">Home</button>
      <button onclick="showSection('folder-reporting')">Folder Reporting</button>
      <button onclick="showSection('text-counter')">Text Counter</button>
      <button onclick="showSection('json-csv')">JSON to CSV</button>
      <button onclick="showSection('path-generator')">Paths Generator</button>
      <button onclick="showSection('batch-copy')">Batch Copy</button>
      <button onclick="showSection('bbox-single')">BBox (Single)</button>
      <button onclick="showSection('bbox-multi')">BBox (Multiple)</button>
      <button onclick="showSection('excel-qa')">Excel QA</button>
      <button onclick="showSection('leave-calc')">Leave Calculator</button>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <section id="home" class="active">
      <p class="lead">Chukwuemeka Umunna</p>
      <h2>My Dashboard</h2>

    <!-- Tabs Navigation -->
    <ul class="nav nav-tabs" id="dashboardTabs" role="tablist">
      <li class="nav-item">
        <a class="nav-link active" id="tasks-tab" data-toggle="tab" href="#tasks" role="tab">To-Do</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="issues-tab" data-toggle="tab" href="#issues" role="tab">Issues</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="calendar-tab" data-toggle="tab" href="#calendar" role="tab">Calendar</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="achievements-tab" data-toggle="tab" href="#achievements" role="tab">Achievements</a>
      </li>

    </ul>

    <!-- Tabs Content -->
    <div class="tab-content" id="dashboardTabsContent">

      <!-- Tasks Tab -->
      <div class="tab-pane fade show active" id="tasks" role="tabpanel">
        <h3 class="mt-3">Task Management</h3>
        <form id="taskForm" action="/manager" class="form-inline mb-3">
          <input type="text" class="form-control mr-2" id="taskTitle" placeholder="Task Title" required />
          <select class="form-control mr-2" id="taskStatus">
            <option>Pending</option>
            <option>In Progress</option>
            <option>Completed</option>
          </select>
          <button type="submit" class="btn btn-primary">Add Task</button>
        </form>

        <div id="taskList">
          {% for task in tasks %}
            <div class="card mb-2">
              <div class="card-body">
                <h5 class="card-title">{{ task.title }}</h5>
                <p class="card-text">Status: {{ task.status }}</p>
                <button class="btn btn-sm btn-warning hide-task" data-id="{{ task.id }}">Hide</button>
                <button class="btn btn-sm btn-danger delete-task" data-id="{{ task.id }}">Delete</button>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>

      <!-- Issues Tab -->
      <div class="tab-pane fade" id="issues" role="tabpanel">
        <h3 class="mt-3">Issues Tracker</h3>
        <form id="issueForm" class="form-inline mb-3">
          <input type="text" class="form-control mr-2" id="issueDesc" placeholder="Issue Description" required />
          <select class="form-control mr-2" id="issueStatus">
            <option>Open</option>
            <option>Resolved</option>
          </select>
          <button type="submit" class="btn btn-danger">Add Issue</button>
        </form>

        <ul class="list-group" id="issueList">
          {% for issue in issues %}
            <li class="list-group-item">
              <strong>ID: {{ issue.id }}</strong> - {{ issue.description }}
              <span class="badge badge-{{ 'danger' if issue.status == 'Open' else 'success' }} float-right">{{ issue.status }}</span>
              <button class="btn btn-sm btn-warning hide-task" data-id="{{ task.id }}">Hide</button>
              <button class="btn btn-sm btn-danger delete-task" data-id="{{ task.id }}">Delete</button>
            </li>
          {% endfor %}
        </ul>
      </div>

      <!-- Calendar Tab -->
      <div class="tab-pane fade" id="calendar" role="tabpanel">
        <h3 class="mt-3">Calendar</h3>

        <form id="calendarForm" class="form-inline mb-3">
          <input type="datetime-local" class="form-control mr-2" id="eventDateTime" required />
          <input type="text" class="form-control mr-2" id="eventDesc" placeholder="Event Description" required />
          <button type="submit" class="btn btn-success">Add Event</button>
        </form>

        <div id="calendarView"style="width: 100%; margin-bottom: 40px;"></div>
      </div>

        <!-- Achievements Tab -->
      <div class="tab-pane fade" id="achievements" role="tabpanel">
<h3 class="mt-3">Achievements</h3>
<form id="achievementForm" class="mb-3">

  <div class="mb-2">
    <input type="text" class="form-control" id="achTask" placeholder="Task Name" required />
  </div>

  <div class="mb-2">
    <textarea class="form-control" id="achDesc" placeholder="Description" required></textarea>
  </div>

  <div class="mb-2">
    <input type="text" class="form-control" id="achProject" placeholder="Project Name" required />
  </div>

  <div class="mb-2">
    <input type="text" class="form-control" id="achManager" placeholder="Project Manager" required />
  </div>

  <div class="mb-2">
    <input type="date" class="form-control" id="achStart" required />
  </div>

  <div class="mb-2">
    <input type="date" class="form-control" id="achEnd" required />
  </div>

  <div class="mb-2">
    <select class="form-control" id="achStatus">
      <option>Completed</option>
      <option>In Progress</option>
      <option>Cancelled</option>
    </select>
  </div>

  <div class="mb-2">
    <textarea class="form-control" id="achComment" placeholder="Comment"></textarea>
  </div>

  <button type="submit" class="btn btn-success">Submit Achievement</button>

</form>
</div>
    </div>
  </div>
  
        <!-- Achievements Tab -->


  <!-- Inject Server Events as JSON -->
  <script>
    const serverEvents = {{ events | default([]) | tojson }};
  </script>

  <!-- JS Dependencies -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>

  <!-- App Scripts -->
  <script>
    // Task Form
    document.getElementById("taskForm").addEventListener("submit", function (e) {
  e.preventDefault();
  const title = document.getElementById("taskTitle").value;
  const status = document.getElementById("taskStatus").value;

  fetch('/add_task', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ title, status })
  })
  .then(res => res.json())
  .then(data => {
    if (data.status === 'success') {
      const card = document.createElement("div");
      card.className = "card mb-2";
      card.innerHTML = `
        <div class="card-body">
          <h5 class="card-title">${title}</h5>
          <p class="card-text">Status: ${status}</p>
        </div>`;
      document.getElementById("taskList").appendChild(card);
      document.getElementById("taskForm").reset();
    } else {
      alert("Failed to add task.");
    }
  });
});


    // Issue Form
    document.getElementById("issueForm").addEventListener("submit", function (e) {
  e.preventDefault();
  const desc = document.getElementById("issueDesc").value;
  const status = document.getElementById("issueStatus").value;
  const badgeClass = status === "Open" ? "danger" : "success";

  fetch('/add_issue', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ description: desc, status })
  })
  .then(res => res.json())
  .then(data => {
    if (data.status === 'success') {
      const item = document.createElement("li");
      item.className = "list-group-item";
      item.innerHTML = `<strong>ID: ${data.issue.id}</strong> - ${desc}
        <span class="badge badge-${badgeClass} float-right">${status}</span>`;
      document.getElementById("issueList").appendChild(item);
      document.getElementById("issueForm").reset();
    } else {
      alert("Failed to add issue.");
    }
  });
});

    // FullCalendar Setup
    document.addEventListener('DOMContentLoaded', function () {
  const calendarEl = document.getElementById('calendarView');
  const calendar = new FullCalendar.Calendar(calendarEl, {
    initialView: 'dayGridMonth',
    headerToolbar: {
      left: 'prev,next today',
      center: 'title',
      right: 'dayGridMonth,timeGridWeek,timeGridDay'
    },
    events: serverEvents,
  });
  calendar.render();

  // Add Event
  document.getElementById("calendarForm").addEventListener("submit", function (e) {
    e.preventDefault();
    const date = document.getElementById("eventDateTime").value;
    const desc = document.getElementById("eventDesc").value;

    fetch('/add_event', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ title: desc, start: date })
    })
    .then(res => res.json())
    .then(data => {
      if (data.status === 'success') {
        calendar.addEvent({
          title: desc,
          start: date,
          allDay: false
        });
        document.getElementById("calendarForm").reset();
      } else {
        alert("Failed to add event.");
      }
    });
  });
});

// Add achievements
document.getElementById("achievementForm").addEventListener("submit", function (e) {
  e.preventDefault();
  const data = {
    task: document.getElementById("achTask").value,
    description: document.getElementById("achDesc").value,
    project: document.getElementById("achProject").value,
    manager: document.getElementById("achManager").value,
    date_started: document.getElementById("achStart").value,
    date_ended: document.getElementById("achEnd").value,
    status: document.getElementById("achStatus").value,
    comment: document.getElementById("achComment").value
  };

  fetch('/add_achievement', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data)
  })
  .then(res => res.json())
  .then(response => {
    if (response.status === 'success') {
      alert("Achievement recorded.");
      document.getElementById("achievementForm").reset();
    } else {
      alert("Failed to save achievement.");
    }
  });
});

  </script>
    </section>

    <section id="folder-reporting">
      <h2>Folder Reporting</h2>
      <form method="POST" action="/folder_report">
        <input type="text" name="folder_path" placeholder="Paste folder path" required />
        <button type="submit">Generate Report</button>
      </form>
    </section>

    <section id="text-counter">
      <h2>Text Counter</h2>
      <textarea id="textInput" rows="6" oninput="countText()"></textarea>
      <div>
        <div id="wordCount" class="WordCount">Words: 0</div>
        <div id="charCount">Characters: 0</div>
      </div>
    </section>

    <section id="json-csv">
      <h2>JSON to CSV Converter</h2>
      <form action="/convert" method="POST">
        <input type="text" name="file_path" placeholder="Json file path" required />
        <button type="submit" name="convert">Convert</button>
      </form>
    </section>

    <section id="path-generator">
      <h2>File & Folder Paths Generator</h2>
      <form action="/generate" method="post">
        <input type="text" name="folder_path" placeholder="Enter folder path" required />
        <button type="submit" name="generate">Generate</button>
      </form>
    </section>

    <section id="batch-copy">
      <h2>Batch Copy File</h2>
      <p>Copies files from a spreadsheet with file paths to designated folders.</p>
    </section>

    <section id="bbox-single">
      <h2>Bounding Box Generator (Single Point)</h2>
      <form method="POST" action="/geobox">
        <input type="text" name="coordinates" placeholder="Place or Coordinates" required />
        <button type="submit">Generate</button>
      </form>
    </section>

    <section id="bbox-multi">
      <h2>Bounding Box Generator (Multiple Points)</h2>
      <form method="POST" action="/geobox_multiple">
        <input type="text" name="coordinates" placeholder="lat,lon;lat,lon;..." required />
        <button type="submit">Generate</button>
      </form>
    </section>

    <section id="excel-qa">
      <h2>Excel QA Report Generator</h2>
      <form method="POST" action="/Excel_reporting" enctype="multipart/form-data">
        <input type="file" name="excel_file" required />
        <button type="submit">Generate Report</button>
      </form>
    </section>

    <section id="leave-calc">
      <h2>Annual Leave Calculator</h2>
      <form method="post" action="/leave_balance">
        <input type="number" step="0.01" name="total_hours" placeholder="Total Leave Hours" required />
        <input type="number" step="0.01" name="daily_hours" placeholder="Daily Work Hours" required />
        <button type="submit">Calculate</button>
      </form>
    </section>
  </div>

  <script>
    function showSection(id) {
      // Hide all sections
      const sections = document.querySelectorAll('section');
      sections.forEach(sec => sec.classList.remove('active'));

      // Remove active class from buttons
      const buttons = document.querySelectorAll('.nav-links button');
      buttons.forEach(btn => btn.classList.remove('active'));

      // Show selected section and highlight button
      document.getElementById(id).classList.add('active');
      const btn = Array.from(buttons).find(b => b.textContent.toLowerCase().includes(id.split('-')[0]));
      if (btn) btn.classList.add('active');
    }

    function countText() {
      const text = document.getElementById('textInput').value;
      fetch('/count', {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: 'text=' + encodeURIComponent(text)
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById('wordCount').innerText = 'Words: ' + data.words;
        document.getElementById('charCount').innerText = 'Characters: ' + data.characters;
      });
    }
  </script>
  <footer class="footer">

  </footer>
</body>
</html>
